import Head from "next/head"
import { GetStaticProps } from "next"
import axios from "axios"
import { gql } from "@apollo/client"
import client from "../apollo/apollo-client"

import HomePage from "../home/screens/Home"

export default function Home({ location_data, business }) {
  console.log(location_data, business)
  return (
    <div>
      <Head>
        <title>Guru Yelp</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <HomePage />
    </div>
  )
}

export const getStaticProps: GetStaticProps = async (context) => {
  try {
    // const { data } = await client.query({
    //   query: gql`
    //     query GetData {
    //       business(id: "garaje-san-francisco") {
    //         name
    //         id
    //         is_claimed
    //         is_closed
    //         url
    //         phone
    //         display_phone
    //         review_count
    //         rating
    //         photos
    //       }
    //     }
    //   `
    // })
    const url_ip = "https://ipgeolocation.abstractapi.com/v1"
    const response = await axios.get(url_ip, {
      params: {
        api_key: process.env.API_KEY_ABSTRACT
      }
    })
    const latitude = response.data.latitude.toString()
    const longitude = response.data.longitude.toString()
    return {
      props: {
        location_data: response.data
        // business: data.business
      },
      revalidate: 300
    }
  } catch (error) {
    return {
      props: {
        error
      }
    }
  }
}
